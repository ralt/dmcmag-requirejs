define(["helpers/xhr"],function(a){function b(b,c){a({url:e({page:b,fields:"nid",parameters:{type:"fiche_receptif"}}),complete:function(a){c(JSON.parse(a))}})}function c(b,c){a({url:e({nid:"/"+b}),complete:function(a){c(d(JSON.parse(a)))}})}function d(a){var b={};return b.title=a.title,a.body=a.body.replace(/<img[^>]+>/g,""),b.body=function(){var b=document.createElement("div");return b.innerHTML=a.body,b=b.querySelector("#para_1"),[].forEach.call(b.getElementsByTagName("img"),function(a){a.parentNode.removeChild(a)}),b}(),b}function e(a){var b="http://www.dmcmag.com/rest_service/node";["nid","page","fields","parameters"].forEach(function(b){a[b]===undefined&&(a[b]="")});var c=b+a.nid+".json?page="+a.page+"&fields="+a.fields;return a.parameters!==""&&Object.keys(a.parameters).forEach(function(b){c+="&parameters["+b+"]="+a.parameters[b]}),c}return{getAll:b,getOne:c}})